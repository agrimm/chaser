#!/usr/local/bin/ruby

$:.unshift File.join(File.dirname(__FILE__), *%w[.. lib])
require 'test_unit_heckler'
require 'optparse'

opts = OptionParser.new do |opts|
  opts.banner = "Usage: #{File.basename($0)} class_name [method_name]"
  opts.on( "-v", "--verbose", "Loudly explain heckle run" ) do |opt|
    TestUnitHeckler.debug = true
  end
  
  opts.on( "-t", "--tests TEST_PATTERN", 
           "Location of tests (glob)" ) do |pattern|
    TestUnitHeckler.test_pattern = pattern
  end
  
  opts.on( "-h", "--help", "Show this message") do |opt|
    puts opts
  end
end

opts.parse!

impl = ARGV.shift
meth = ARGV.shift

unless impl then
  puts opts
  exit 1
end

if meth
  heckle = TestUnitHeckler.new(impl, meth)
  heckle.validate
else
  TestUnitHeckler.validate(impl)
end
